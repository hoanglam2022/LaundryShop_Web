{"ast":null,"code":"import { FETCH_USER_GENERAL_ACTION, FETCH_USER_ORDERS_ACTION, FETCH_USER_TRANSACTIONS_ACTION, PENDING_FETCH_USER_GENERAL_ACTION, PENDING_FETCH_USER_ORDERS_ACTION, PENDING_FETCH_USER_TRANSACTIONS_ACTION } from \"./constants\"; //import db from \"../../../database/firestore\";\n//const refMstUser = db.collection('mst_user')\n// ========================== User general ==========================\n\nexport function fetchUserGeneral(username) {\n  return dispatch => {\n    dispatch(pendingFetchUserGeneralAction());\n    dispatch(fetchUserGeneralAction(dispatch, {\n      data: data\n    }));\n    /*return refMstUser.where('username', '==', username).limit(1).get().then(snapshot => {\n        let data = null;\n        snapshot.forEach(doc => {\n            data = {\n                id: doc.id,\n                ...doc.data(),\n                balance: 0\n            }\n             return refMstUser.doc(doc.id).collection('transactions').get().then(snapshot_tran => {\n                let balance = 0;\n                snapshot_tran.forEach(doc_tran => {\n                    balance += parseInt(doc_tran.data().amount)\n                })\n                data.balance = balance;\n            }).finally(() => {\n                dispatch(fetchUserGeneralAction(dispatch, {data: data}));\n            });\n        });\n    })*/\n  };\n}\nexport function pendingFetchUserGeneralAction() {\n  return {\n    type: PENDING_FETCH_USER_GENERAL_ACTION,\n    payload: true\n  };\n}\nexport function fetchUserGeneralAction(dispatch, data) {\n  return {\n    type: FETCH_USER_GENERAL_ACTION,\n    payload: data.data\n  };\n} //========================== User transactions ==========================\n\nexport function fetchUserTransactions(username) {\n  return dispatch => {\n    dispatch(pendingFetchUserTransactionsAction());\n    return refMstUser.where('username', '==', username).limit(1).get().then(snapshot => {\n      snapshot.forEach(doc => {\n        let list = [];\n        return refMstUser.doc(doc.id).collection('transactions').get().then(snapshot_tran => {\n          snapshot_tran.forEach(doc_tran => {\n            let item = {\n              id: doc_tran.id,\n              ...doc_tran.data()\n            };\n            list.push(item);\n          });\n        }).finally(() => {\n          dispatch(fetchUserTransactionAction(dispatch, {\n            data: list\n          }));\n        });\n      });\n    });\n  };\n}\nexport function pendingFetchUserTransactionsAction() {\n  return {\n    type: PENDING_FETCH_USER_TRANSACTIONS_ACTION,\n    payload: true\n  };\n}\nexport function fetchUserTransactionAction(dispatch, data) {\n  return {\n    type: FETCH_USER_TRANSACTIONS_ACTION,\n    payload: data.data !== undefined && data.data !== null ? data.data : []\n  };\n} // ========================== User orders ==========================\n\nexport function fetchUserOrders(username) {\n  return dispatch => {\n    dispatch(pendingFetchUserOrdersAction());\n    return refMstUser.where('username', '==', username).limit(1).get().then(snapshot => {\n      snapshot.forEach(doc => {\n        let list = [];\n        return refMstUser.doc(doc.id).collection('orders').get().then(snapshot_order => {\n          snapshot_order.forEach(doc_order => {\n            let item = {\n              id: doc_order.id,\n              ...doc_order.data()\n            };\n            list.push(item);\n          });\n        }).finally(() => {\n          dispatch(fetchUserOrdersAction(dispatch, {\n            data: list\n          }));\n        });\n      });\n    });\n  };\n}\nexport function pendingFetchUserOrdersAction() {\n  return {\n    type: PENDING_FETCH_USER_ORDERS_ACTION,\n    payload: true\n  };\n}\nexport function fetchUserOrdersAction(dispatch, data) {\n  return {\n    type: FETCH_USER_ORDERS_ACTION,\n    payload: data.data !== undefined && data.data !== null ? data.data : []\n  };\n}","map":{"version":3,"sources":["/Users/trantuan/LaundryShop/laundry-shop-admin/application/src/features/Users/redux/actions.js"],"names":["FETCH_USER_GENERAL_ACTION","FETCH_USER_ORDERS_ACTION","FETCH_USER_TRANSACTIONS_ACTION","PENDING_FETCH_USER_GENERAL_ACTION","PENDING_FETCH_USER_ORDERS_ACTION","PENDING_FETCH_USER_TRANSACTIONS_ACTION","fetchUserGeneral","username","dispatch","pendingFetchUserGeneralAction","fetchUserGeneralAction","data","type","payload","fetchUserTransactions","pendingFetchUserTransactionsAction","refMstUser","where","limit","get","then","snapshot","forEach","doc","list","id","collection","snapshot_tran","doc_tran","item","push","finally","fetchUserTransactionAction","undefined","fetchUserOrders","pendingFetchUserOrdersAction","snapshot_order","doc_order","fetchUserOrdersAction"],"mappings":"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","sourcesContent":["import {\n    FETCH_USER_GENERAL_ACTION,\n    FETCH_USER_ORDERS_ACTION,\n    FETCH_USER_TRANSACTIONS_ACTION,\n    PENDING_FETCH_USER_GENERAL_ACTION,\n    PENDING_FETCH_USER_ORDERS_ACTION,\n    PENDING_FETCH_USER_TRANSACTIONS_ACTION,\n} from \"./constants\";\n//import db from \"../../../database/firestore\";\n\n//const refMstUser = db.collection('mst_user')\n\n// ========================== User general ==========================\nexport function fetchUserGeneral(username) {\n    return dispatch => {\n        dispatch(pendingFetchUserGeneralAction())\n        dispatch(fetchUserGeneralAction(dispatch, {data: data}));\n        /*return refMstUser.where('username', '==', username).limit(1).get().then(snapshot => {\n            let data = null;\n            snapshot.forEach(doc => {\n                data = {\n                    id: doc.id,\n                    ...doc.data(),\n                    balance: 0\n                }\n\n                return refMstUser.doc(doc.id).collection('transactions').get().then(snapshot_tran => {\n                    let balance = 0;\n                    snapshot_tran.forEach(doc_tran => {\n                        balance += parseInt(doc_tran.data().amount)\n                    })\n                    data.balance = balance;\n                }).finally(() => {\n                    dispatch(fetchUserGeneralAction(dispatch, {data: data}));\n                });\n            });\n        })*/\n    }\n}\n\nexport function pendingFetchUserGeneralAction() {\n    return {\n        type: PENDING_FETCH_USER_GENERAL_ACTION,\n        payload: true\n    };\n}\n\nexport function fetchUserGeneralAction(dispatch, data) {\n    return {\n        type: FETCH_USER_GENERAL_ACTION,\n        payload: data.data\n    };\n}\n\n//========================== User transactions ==========================\nexport function fetchUserTransactions(username) {\n    return dispatch => {\n        dispatch(pendingFetchUserTransactionsAction())\n        return refMstUser.where('username', '==', username).limit(1).get().then(snapshot => {\n            snapshot.forEach(doc => {\n                let list = [];\n                return refMstUser.doc(doc.id).collection('transactions').get().then(snapshot_tran => {\n                    snapshot_tran.forEach(doc_tran => {\n                        let item = {\n                            id: doc_tran.id,\n                            ...doc_tran.data()\n                        }\n                        list.push(item);\n                    })\n                }).finally(() => {\n                    dispatch(fetchUserTransactionAction(dispatch, {data: list}));\n                });\n            });\n        })\n    }\n}\n\nexport function pendingFetchUserTransactionsAction() {\n    return {\n        type: PENDING_FETCH_USER_TRANSACTIONS_ACTION,\n        payload: true\n    };\n}\n\nexport function fetchUserTransactionAction(dispatch, data) {\n    return {\n        type: FETCH_USER_TRANSACTIONS_ACTION,\n        payload: data.data !== undefined && data.data !== null ? data.data : []\n    };\n}\n\n// ========================== User orders ==========================\nexport function fetchUserOrders(username) {\n    return dispatch => {\n        dispatch(pendingFetchUserOrdersAction())\n        return refMstUser.where('username', '==', username).limit(1).get().then(snapshot => {\n            snapshot.forEach(doc => {\n                let list = [];\n                return refMstUser.doc(doc.id).collection('orders').get().then(snapshot_order => {\n                    snapshot_order.forEach(doc_order => {\n                        let item = {\n                            id: doc_order.id,\n                            ...doc_order.data()\n                        }\n                        list.push(item);\n                    })\n                }).finally(() => {\n                    dispatch(fetchUserOrdersAction(dispatch, {data: list}));\n                });\n            });\n        })\n    }\n}\n\nexport function pendingFetchUserOrdersAction() {\n    return {\n        type: PENDING_FETCH_USER_ORDERS_ACTION,\n        payload: true\n    };\n}\n\nexport function fetchUserOrdersAction(dispatch, data) {\n    return {\n        type: FETCH_USER_ORDERS_ACTION,\n        payload: data.data !== undefined && data.data !== null ? data.data : []\n    };\n}\n"]},"metadata":{},"sourceType":"module"}